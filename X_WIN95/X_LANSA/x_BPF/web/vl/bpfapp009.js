LANSA.addComponent({id:"BPFAPP009",nm:"BPFActionMessages",ot:"rp",tp:"Reusable Part",pt:"ap",de:"Portal Inter Window Messages",tl:15000300},function(l,oI,u){var cL="ENG";var Fd={F1:{nm:"BPFFLD061",an:"BPFGenericDateTime",ft:"DT",ln:26,dc:0,lb:"Generic Date Ti",h1:"Generic",h2:"Date",h3:"Time",de:"Generic Date Time",dv:l.SqlNull,ia:["ASQN","ISO","SUTC"]}};var cO=l.rC(oI,{an:"PRIM_OBJT",fd:Fd,rm:["dt"],mt:{SendAction:{ps:{"MessageValue":{pt:"i"}}}},ev:{OnActionRecieved:{ps:{"ActionValue":{pt:"i"}}}
},co:function(){cO.aN.call(this);this.aF("BPFAPP009",Fd);var C0=this.cR("BLOCKMESSAGEACTION","PRIM_BOLN");var C1=this.cR("CURRENTEVENTID","PRIM_ALPH");var C2=this.cR("ACTIONVALUE","PRIM_ALPH");var C3=this.cR("MESSAQESTRING","PRIM_ALPH");var C4=this.cR("ACTIONEVENTID","PRIM_ALPH");var C5=this.cR("SIGNALDELAY","PRIM_TIMR");C0.iC();C1.iC();C2.iC();C3.iC();C4.iC();C5.setInterval(1);C5.setStartup("MANUAL");C5.iC();l.WEB().aH("STORAGECHANGED",this,e3);C5.aH("TICK",this,e4);this.aH("CREATEINSTANCE",this,e1);
this.aH("DESTROYINSTANCE",this,e2);}});function e1(sender,Ps){var m=this.REF,r=l.eR(this,cO,"#COM_OWNER.CreateInstance",30);r.ln=30;{r.ln=33;m.BLOCKMESSAGEACTION.set(true);r.ln=37;if(l.and(l.WEB().getSessionStorage().getAvailable(),l.WEB().getLocalStorage().getAvailable())){r.ln=40;if((l.WEB().getLocalStorage().get("BPF.MESSAGE.CHANNEL")==null)){r.ln=43;l.WEB().getLocalStorage().mthADD("BPF.MESSAGE.CHANNEL","");}else{r.ln=48;l.WEB().getLocalStorage().get("BPF.MESSAGE.CHANNEL").setValue("");}}r.ln=55;
m.BLOCKMESSAGEACTION.set(false);}r.ln=57;r.e();};function e2(sender,Ps){var r=l.eR(this,cO,"#COM_OWNER.DestroyInstance",60);r.ln=60;{r.ln=62;l.WEB().getLocalStorage().mthREMOVE("BPF.MESSAGE.CHANNEL");}r.ln=64;r.e();};function e3(sender,Ps){var m=this.REF,r=l.eR(this,cO,"#SYS_WEB.StorageChanged",70);var P0=Ps.r("STORAGETYPE");r.ln=70;{r.ln=73;if(l.tB(m.BLOCKMESSAGEACTION.get())){r.e();return;}r.ln=80;if(l.s.eq(P0.get(),"SESSIONSTORAGE")){r.e();return;}r.ln=87;if((l.WEB().getLocalStorage().get("BPF.MESSAGE.CHANNEL")!=null))
{r.ln=89;m.MESSAQESTRING.set(l.WEB().getLocalStorage().get("BPF.MESSAGE.CHANNEL").getValue());r.ln=91;m.SIGNALDELAY.mthSTOP();r.ln=92;m.SIGNALDELAY.mthSTART();}}r.ln=96;r.e();};function e4(sender,Ps){var m=this.REF,r=l.eR(this,cO,"#SignalDelay.Tick",98);r.ln=98;{r.ln=101;m.SIGNALDELAY.mthSTOP();r.ln=104;if(l.b.IsFalse(l.s.IsNull(m.MESSAQESTRING.get()))){r.ln=106;if(l.and(l.s.Contains(m.MESSAQESTRING.get(),"ID: \""),l.s.Contains(m.MESSAQESTRING.get(),"MSG: \""))){r.ln=109;m.ACTIONEVENTID.set(l.s.Substring(m.MESSAQESTRING.get(),7,l.sub(l.sub(l.s.PositionOf(m.MESSAQESTRING.get(),"\","),1),6)));
r.ln=110;m.ACTIONVALUE.set(l.s.Remove(l.s.Substring(m.MESSAQESTRING.get(),l.add(l.s.LastPositionOf(m.MESSAQESTRING.get(),": \""),3)),"\"}"));r.ln=113;if(l.tB(l.s.ne(m.CURRENTEVENTID.get(),m.ACTIONEVENTID.get()))){r.ln=115;m.CURRENTEVENTID.set(m.ACTIONEVENTID.get());r.ln=116;{var eP=l.ePs();eP.cR("ACTIONVALUE","PRIM_ALPH");eP.r("ACTIONVALUE").set(m.ACTIONVALUE.get());this.fE("ONACTIONRECIEVED",eP);eP.e();}}}}}r.ln=125;r.e();};cO.mthSENDACTION=function(p0){var f=this.FLD.BPFAPP009,m=this.REF,r=l.mR(this,cO,"SendAction",127);
var P0=r.cP("MESSAGEVALUE","PRIM_ALPH");P0.set((p0===u)?(null):(p0));r.ln=127;{r.ln=130;if(l.b.IsFalse(l.s.IsNull(P0.get()))){r.ln=133;m.BLOCKMESSAGEACTION.set(true);r.ln=136;m.CURRENTEVENTID.set(l.n.AsString(l.dt.AsSeconds(l.dt.Now(f.F1.get()))));r.ln=137;l.WEB().getLocalStorage().get("BPF.MESSAGE.CHANNEL").setValue(l.cat(l.cat(l.cat(l.cat("{ID: \"",m.CURRENTEVENTID.get()),"\", MSG: \""),P0.get()),"\"}"));}r.ln=142;m.BLOCKMESSAGEACTION.set(false);}r.ln=144;r.e();};},{rp:["PRIM_OBJT","PRIM_BOLN","PRIM_ALPH","PRIM_TIMR","PRIM_DTIM","PRIM_FLD"]
});