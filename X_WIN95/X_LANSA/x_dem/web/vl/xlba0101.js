LANSA.addComponent({id:"XLBA0101",nm:"XInternal_DeviceSqlDb_QueryExecutionQueue",ot:"rp",tp:"Reusable Part",de:"[pkg-lansa-mobile]",tl:14020401},function(l,oI,u){var cL="ENG";var Fd={F1:{ic:0,nm:"XLB00051",an:"XLib_INT64",ft:"I",ln:8,dc:0,lb:"Int64",h1:"Int64",h2:" ",h3:" ",de:"Extended Library - Int64 Data Type",dv:0,ia:["FE","RB"]}};var cO=l.rC(oI,{an:"XLBA0092",fd:Fd,mt:{Queue:{ps:{"Query":{pt:"i"}}},QueueImpl:{ps:{"Query":{pt:"i"},"ParentContext":{pt:"i"}}},ExecuteNext:{},ExecuteQueryImpl:{ps:
{"ArgsJson":{pt:"i"}}},FinalizeQueryExecution:{ps:{"TargetContext":{pt:"i"},"Rows":{pt:"i"},"Status":{pt:"i"},"Message":{pt:"i"}}},BeginExecute:{},EndExecute:{}},ev:{QueryCompleted:{ps:{"Context":{pt:"i"},"Result":{pt:"i"}}}},co:function(){cO.aN.call(this);this.aF("XLBA0101",Fd);var C0=this.cR("GISEXECUTING","PRIM_BOLN");var C1=this.cR("GLIST","PRIM_LCOL");this.cD("EXECUTINGCONTEXT");this.cD("GWIDGET");this.cD("GARGSCONVERTER");C0.iC();C1.setCollects("XLBA0102");C1.iC();}});cO.mthQUEUE=function(p0)
{var m=this.REF,r=l.mR(this,cO,"Queue",14);var P0=r.cPD("QUERY");P0=p0;r.ln=14;{r.ln=17;this.mthQUEUEIMPL(P0,u);r.ln=19;if(l.tB(l.not(m.GISEXECUTING.get()))){r.ln=20;this.mthBEGINEXECUTE();}}r.ln=22;r.e();};cO.mthQUEUEIMPL=function(p0,p1){var m=this.REF,r=l.mR(this,cO,"QueueImpl",24);var P0=r.cPD("QUERY");var P1=r.cPD("PARENTCONTEXT");P0=p0;P1=(p1===u)?(null):(p1);var C0=r.cD("C0");var C1=r.cF("I",Fd.F1.Dc);C1.iC();r.ln=24;{r.ln=31;C0=r.sR("C0",l.cAs("XLBA0102",u,"mthCREATE",[P0,P1]));r.ln=33;if(l.n.gt(P0.getQUERYCOUNT(),0))
{r.ln=34;for(var i1=1,s1=1,t1=l.tI(P0.getQUERYCOUNT());C1.set(i1),(((s1>=0)&&(i1<=t1))||((s1<0)&&(i1>=t1)));i1+=s1){r.ln=35;this.mthQUEUEIMPL(P0.getQUERYAT(C1.get()),C0);}}else{r.ln=38;m.GLIST.mthINSERT(C0);}}r.ln=41;r.e();};cO.mthEXECUTENEXT=function(){var m=this.REF,r=l.mR(this,cO,"ExecuteNext",43);var C0=r.cD("C0");var C1=r.cD("C1");var C2=r.cD("C2");r.ln=43;{r.ln=48;if(l.tB(l.not(m.GISEXECUTING.get()))){r.ln=49;this.mthFATALERROR("Query executor is not running");}r.ln=52;if((m.EXECUTINGCONTEXT!=null))
{r.ln=53;this.mthFATALERROR("Looks like the previous query has not completed execution");}r.ln=56;if(l.n.eq(m.GLIST.getItemCount(),0)){r.ln=57;this.mthFATALERROR("No more item to execute");}r.ln=61;C0=r.sR("C0",m.GLIST.getFirst().getQUERY());r.ln=62;C1=r.sR("C1",l.cAs("XLBA0103",u,"mthCREATE",[C0.getARGUMENTS()]));r.ln=64;if(C1.mthHASASYNCTRANSFORM()){r.ln=65;this.setrefGARGSCONVERTER(C1);r.ln=66;C1.mthCONVERTASYNC();}else{r.ln=68;C2=r.sR("C2",C1.mthCONVERT());r.ln=69;this.mthEXECUTEQUERYIMPL(C2);
}}r.ln=71;r.e();};function e1(sender,Ps){var m=this.REF,r=l.eR(this,cO,"#gArgsConverter.AsyncCompleted",73);var P0=Ps.r("RESULT");r.ln=73;{r.ln=74;this.setrefGARGSCONVERTER(null);r.ln=76;this.mthEXECUTEQUERYIMPL(P0);}r.ln=77;r.e();};cO.mthEXECUTEQUERYIMPL=function(p0){var m=this.REF,r=l.mR(this,cO,"ExecuteQueryImpl",79);var P0=r.cPD("ARGSJSON");P0=p0;var C0=r.cD("C0");r.ln=79;{r.ln=84;this.setrefEXECUTINGCONTEXT(m.GLIST.mthREMOVEFIRST());r.ln=86;C0=r.sR("C0",m.EXECUTINGCONTEXT.getQUERY());r.ln=87;
this.setrefGWIDGET(l.cC("XLBA0093"));r.ln=89;m.GWIDGET.mthEXECUTESQL(C0.getSQL(),P0.get());}r.ln=90;r.e();};function e2(sender,Ps){var m=this.REF,r=l.eR(this,cO,"#gWidget.ExecuteSqlCompleted",92);var P0=Ps.r("ROWS");var P1=Ps.r("STATUS");var P2=Ps.r("MESSAGE");var C0=r.cD("C0");r.ln=92;{r.ln=95;if(l.and(l.s.eq(P1.get(),"OK"),l.s.ne(P0.get(),""))){r.ln=96;C0=r.sR("C0",l.cC("PRIM_WEB","Json"));r.ln=97;C0.setText(P0.get());}r.ln=100;this.mthFINALIZEQUERYEXECUTION(m.EXECUTINGCONTEXT,C0,P1.get(),P2.get());
r.ln=102;this.setrefGWIDGET(null);r.ln=103;this.setrefEXECUTINGCONTEXT(null);r.ln=106;if(l.n.gt(m.GLIST.getItemCount(),0)){r.ln=107;this.mthEXECUTENEXT();}else{r.ln=109;this.mthENDEXECUTE();}}r.ln=111;r.e();};cO.mthFINALIZEQUERYEXECUTION=function(p0,p1,p2,p3){var r=l.mR(this,cO,"FinalizeQueryExecution",113);var P0=r.cPD("TARGETCONTEXT");var P1=r.cPD("ROWS");var P2=r.cP("STATUS","PRIM_DC","UnicodeString");var P3=r.cP("MESSAGE","PRIM_DC","UnicodeString");P0=p0;P1=p1;P2.set(p2);P3.set(p3);var C0=r.cD("C0");
var C1=r.cD("C1");var C2=r.cD("C2");var C3=r.cR("PARENTQUERYSTATUS","PRIM_DC","UnicodeString");C3.iC();r.ln=113;{r.ln=124;C0=r.sR("C0",P0.getQUERY());r.ln=125;C1=r.sR("C1",P0.mthCREATERESULT(P1,P2.get(),P3.get()));r.ln=127;{var eP=l.ePs();eP.cD("CONTEXT");eP.cD("RESULT");eP.sR("CONTEXT",P0);eP.sR("RESULT",C1);this.fE("QUERYCOMPLETED",eP);eP.e();}r.ln=129;C2=r.sR("C2",P0.getPARENTCONTEXT());r.ln=130;if((C2!=null)){r.ln=131;if(C2.mthISSUBRESULTSCOMPLETE()){r.ln=132;C3.set("OK");r.ln=134;if(C2.getHASFAILEDSUBQUERY())
{r.ln=135;C3.set("GROUP_ERROR");}r.ln=138;this.mthFINALIZEQUERYEXECUTION(P0.getPARENTCONTEXT(),null,C3.get(),"");}}}r.ln=141;r.e();};cO.mthBEGINEXECUTE=function(){var m=this.REF,r=l.mR(this,cO,"BeginExecute",143);r.ln=143;{r.ln=144;if(l.tB(m.GISEXECUTING.get())){r.ln=145;this.mthFATALERROR("Query executor is already running");}r.ln=148;m.GISEXECUTING.set(true);r.ln=150;this.mthEXECUTENEXT();}r.ln=151;r.e();};cO.mthENDEXECUTE=function(){var m=this.REF,r=l.mR(this,cO,"EndExecute",153);r.ln=153;{r.ln=154;
if(l.tB(l.not(m.GISEXECUTING.get()))){r.ln=155;this.mthFATALERROR("Query executor is not running");}r.ln=158;m.GISEXECUTING.set(false);}r.ln=159;r.e();};{Fd.F1.Dc=function(){this.aN.call(this,Fd.F1);};l.cFC({co:Fd.F1.Dc,an:"PRIM_FLD",fn:"XLB00051"});}cO.setrefEXECUTINGCONTEXT=function(rn){this.sR("EXECUTINGCONTEXT",rn);};cO.setrefGWIDGET=function(rn){if(this.REF.GWIDGET!=null){this.REF.GWIDGET.rH("EXECUTESQLCOMPLETED",this,e2);}this.sR("GWIDGET",rn);if(this.REF.GWIDGET!=null){this.REF.GWIDGET.aH("EXECUTESQLCOMPLETED",this,e2);
}};cO.setrefGARGSCONVERTER=function(rn){if(this.REF.GARGSCONVERTER!=null){this.REF.GARGSCONVERTER.rH("ASYNCCOMPLETED",this,e1);}this.sR("GARGSCONVERTER",rn);if(this.REF.GARGSCONVERTER!=null){this.REF.GARGSCONVERTER.aH("ASYNCCOMPLETED",this,e1);}};},{rc:["XLBA0092"],rp:["PRIM_BOLN","PRIM_LCOL","PRIM_FLD"],dc:["XLBA0102","XLBA0093","XLBA0103","XLBA0098","XLBA0096"],dp:["PRIM_WEB.Json","PRIM_DC.UnicodeString"]});