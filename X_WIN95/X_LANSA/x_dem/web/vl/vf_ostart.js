LANSA.addComponent({id:"VF_OSTART",ot:"wp",tp:"Web Page",pt:"ap",de:"Start VLF-ONE from external login",tl:15000000},function(l,oI,u){var cL="ENG";if((l.gCL()=="FRA")||(l.gCL()=="JPN")){cL=l.gCL();}var Fd={F1:{ic:0,nm:"STD_INT",ft:"I",ln:4,dc:0,ec:"J",lb:{"ENG":"Std Integer","FRA":"?","JPN":"?"}[cL],h1:{"ENG":"Standard","FRA":"?","JPN":"?"}[cL],h2:{"ENG":"Integer","FRA":"?","JPN":"?"}[cL],h3:{"ENG":"Field","FRA":"?","JPN":"?"}[cL],de:{"ENG":"Standard Integer field","FRA":"?","JPN":"?"}[cL],dv:0,ia:["FE","RB"]
},F2:{ic:0,nm:"VF_ELIDN",ft:"A",ln:32,dc:0,lb:{"ENG":"Internal Identi","FRA":"Standard Identi","JPN":"Standard Identi"}[cL],h1:{"ENG":"Internal","FRA":"Standard","JPN":"Standard"}[cL],h2:"Identifier",h3:"",de:{"ENG":"Internal Identifier","FRA":"Standard Identifier","JPN":"Standard Identifier"}[cL],dv:"",ia:["FE"]},F3:{nm:"VF_ELTRCT",ft:"DT",ln:26,dc:0,lb:"Trace Time",h1:"Trace",h2:"Time",h3:"",de:"Trace Time",dv:l.SqlNull,ia:["ASQN","FE","ISO","DUTC"]}};var cO=l.rC(oI,{an:"PRIM_WEB",fd:Fd,rm:["dt"],
co:function(){cO.aN.call(this);this.aF("VF_OSTART",Fd);this.setTheme(l.THEME().get("MATERIALDESIGNBLUE"));this.aH("INITIALIZE",this,e1);}});function e1(sender,Ps){var f=this.FLD.VF_OSTART,r=l.eR(this,cO,"#Com_owner.Initialize",4);var C0=r.cDR("COMPLETEOAUTH2LOGIN","VF_SW103O","COMPLETEOAUTH2LOGIN");var C1=r.cR("STATUS","PRIM_DC","UnicodeString");var C2=r.cR("REDIRECTURL","PRIM_DC","UnicodeString");var C3=r.cF("QMPOS",Fd.F1.Dc);var C4=r.cR("ADDITIONALSTATE","PRIM_DC","UnicodeString");var C5=r.cR("CLIENTAUTHTOKEN","PRIM_DC","UnicodeString");
var C6=r.cR("ERRORCODE","PRIM_DC","UnicodeString");var C7=r.cR("ERRORMESSAGE","PRIM_DC","UnicodeString");var C8=r.cF("ASSIGNEDGUID",Fd.F2.Dc);var C9=r.cR("PRIMARYEMAIL","PRIM_DC","UnicodeString");var C10=r.cR("FIRSTNAME","PRIM_DC","UnicodeString");var C11=r.cR("GIVENNAME","PRIM_DC","UnicodeString");var C12=r.cR("ENCRYPTKEY","PRIM_DC","UnicodeString");var C13=r.cR("JSON","PRIM_WEB","Json");var C14=r.cD("C14");C0.iC();C1.iC();C2.iC();C3.iC();C4.iC();C5.iC();C6.iC();C7.iC();C8.iC();C9.iC();C10.iC();
C11.iC();C12.iC();C13.iC();r.ln=4;{r.ln=24;if(((l.WEB().getURLParameters().get("code")!=null)&&(l.WEB().getURLParameters().get("state")!=null))){r.ln=26;C3.set(l.s.PositionOf(l.WEB().getURL(),"?"));r.ln=27;if(l.n.ne(C3.get(),0)){r.ln=28;C2.set(l.s.Substring(l.WEB().getURL(),1,l.sub(C3.get(),1)));}else{r.ln=31;C2.set(l.WEB().getURL());}r.ln=34;C0.mthEXECUTE({FLD:{"FLD_OAUTH2AUTHORIZATIONCODE":l.WEB().getURLParameters().get("code").getValue(),"FLD_OAUTH2REDIRECTURL":C2.get(),"FLD_OAUTH2CALLBACKDATA":l.WEB().getURLParameters().get("state").getValue()}},{FLD:{"FLD_STATUS":C1,"FLD_ADDITIONALSTATE":C4,"FLD_CLIENTAUTHTOKEN":C5,"FLD_ERRORCODE":C6,"FLD_ERRORMESSAGE":C7,"FLD_ASSIGNEDGUID":C8,"FLD_PRIMARYEMAIL":C9,"FLD_FIRSTNAME":C10,"FLD_GIVENNAME":C11}});
r.ln=36;if(l.s.eq(l.s.UpperCase(C1.get()),"TRUE")){r.ln=38;C14=r.sR("C14",C13.mthCREATEROOTOBJECT());r.ln=40;C12.set(l.s.Substring(C5.get(),1,16));r.ln=41;C14.mthINSERTSTRING("clientauthtoken",l.s.Reverse(C5.get()));r.ln=42;C14.mthINSERTSTRING("created",l.s.Encrypt(l.s.Reverse(l.n.AsString(l.dt.AsSeconds(l.dt.Now(f.F3.get())))),C12.get()));r.ln=43;C14.mthINSERTSTRING("email",l.s.Encrypt(C9.get(),C12.get()));r.ln=44;C14.mthINSERTSTRING("first",l.s.Encrypt(C10.get(),C12.get()));r.ln=45;C14.mthINSERTSTRING("given",l.s.Encrypt(C11.get(),C12.get()));
r.ln=47;l.WEB().getLocalStorage().mthADD(l.cat("VF_OSTART_",C8.get()),C13.get());r.ln=49;C3.set(l.s.PositionOf(C4.get(),"?"));r.ln=50;if(l.n.ne(C3.get(),0)){r.ln=51;l.WEB().mthNAVIGATE(l.cat(l.cat(C4.get(),"&guidtoken="),C8.get()),"CURRENT");}else{r.ln=53;l.WEB().mthNAVIGATE(l.cat(l.cat(C4.get(),"?guidtoken="),C8.get()),"CURRENT");}}else{r.ln=58;l.WEB().mthALERT(l.add(l.cat(l.add("Logon request failed. ErrorCode=",C6.get()),", ErrorMessage="),C7.get()));}}else{r.ln=65;l.WEB().mthALERT("Invalid use of VF_OSTART. Request ignored");
}}r.ln=69;r.e();};{Fd.F1.Dc=function(){this.aN.call(this,Fd.F1);};l.cFC({co:Fd.F1.Dc,an:"PRIM_FLD",fn:"STD_INT"});}{Fd.F2.Dc=function(){this.aN.call(this,Fd.F2);};l.cFC({co:Fd.F2.Dc,an:"PRIM_FLD",fn:"VF_ELIDN"});}},{rp:["PRIM_WEB","PRIM_WEB.DataRequest","PRIM_FLD","PRIM_DTIM"],dp:["PRIM_DC.UnicodeString","PRIM_WEB.Json","PRIM_WEB.JsonObject"]});